<?xml version="1.0"	encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper	namespace="admin">

	<select id="access" resultType="HashMap">
		SELECT * FROM member 
		where member_id=#{id} AND member_pw=HEX(AES_ENCRYPT(#{pw}, 'teamc'))
		AND member_grade = 3 
	</select>
	
	<select id="logList" resultType="HashMap">
		SELECT * FROM log WHERE log_del = 1 
			<if test="ip != '' and target == ''">
				AND log_ip = #{ip}
			</if>
			
			<if test="ip == '' and target != ''">
				AND log_target=#{target}
			</if>
			
			<if test="ip != '' and target != ''">
				AND log_ip = #{ip} AND log_target=#{target}
			</if>
		
		limit #{startPage}, #{lastPage}
	</select>
		
	<select	id="totalCount" parameterType="HashMap" resultType="HashMap">
		SELECT COUNT(*) as totalCount FROM log WHERE log_del = 1 
		<if test="ip != '' and target == ''">
		AND log_ip = #{ip}
		</if>
		
		<if test="ip == '' and target != ''">
		AND log_ip = #{ip} AND log_target=#{target}
		</if>
		
		<if test="ip != '' and target != ''">
		AND log_ip = #{ip} AND log_target=#{target}
		</if>
	</select>

	<select	id="ipList" resultType="Object">
		SELECT DISTINCT log_ip FROM log
	</select>

	<select	id="targetList" resultType="Object">
		SELECT DISTINCT log_target FROM log
	</select>	
	
	<update id="deleteLog">
		UPDATE log SET log_del=0 WHERE log_no=#{number} 
	</update>
	
</mapper>